---
title: "Untitled"
author: "Eric"
date: "2017年6月11日"
output: html_document
runtime: shiny
---

```{r}
library(magrittr)
library(data.table)
library(ggplot2)
library(dplyr)
library(ggvis)

dat <- fread('data/591rent.csv')

# 租金
dat %>% ggplot(aes(x = '租金', y = 租金)) +
  geom_violin(fill = "#56B4E9") +
  geom_boxplot(width = 0.2) +
  stat_summary(geom="text", fun.y=quantile,
               aes(label=sprintf("%1.0f", ..y..)),
               position=position_nudge(x=0.15), size=3.5) +
  theme(axis.text.x = element_blank(), 
        axis.title.x = element_blank()) +
  scale_y_continuous(breaks = seq(0, 80000, 10000))

# 是否有黃金曝光
dat %<>% mutate(是否有黃金曝光 = factor(是否有黃金曝光))

dat %>% ggplot(aes(是否有黃金曝光, fill = 是否有黃金曝光)) +  
  geom_bar() +
  geom_text(aes(y = ..count.., label = ..count..), stat = 'count',
            size = 6) +
  guides(fill = F)

dat %>% ggplot(aes(是否有黃金曝光, 租金, fill = 是否有黃金曝光)) +
  geom_boxplot() + guides(fill = F)

# 總樓層
dat %>% ggplot(aes(總樓層)) + geom_histogram()
dat %>% ggplot(aes(總樓層, 租金)) + geom_jitter(width = 0.25)
dat %>% ggplot(aes(總樓層, 租金)) + geom_point() + geom_smooth()

# 坪數
dat %>% ggvis(~坪數) %>% 
  layer_histograms(
    width = input_slider(min = 3, max = 20, value = 10, step = 1, label = 'width'),
    boundary = 0
  )

dat %>% ggplot(aes(坪數)) +
  geom_histogram(binwidth = 5, boundary = 0)
dat %>% ggplot(aes(坪數)) +
  geom_histogram(binwidth = 10, boundary = 0)


```

